"use strict";(self.webpackChunkdocs_reanimated=self.webpackChunkdocs_reanimated||[]).push([[5793],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>v});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),h=r,v=m["".concat(s,".").concat(h)]||m[h]||d[h]||i;return n?a.createElement(v,o(o({ref:t},c),{},{components:n})):a.createElement(v,o({ref:t},c))}));function v(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var u=2;u<i;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},43198:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>w,contentTitle:()=>N,default:()=>M,frontMatter:()=>L,metadata:()=>x,toc:()=>F});var a=n(87462),r=n(67294),i=n(3905),o=n(67177),l=n(28033),s=n(42233);const u={code:"function FrameCallbackSimpleTsx1(frameInfo){const{t}=this.__closure;t.value=frameInfo.timeSinceFirstFrame/350;}"},c={code:"function FrameCallbackSimpleTsx2(){const{t,width}=this.__closure;const scale=2/(3-Math.cos(2*t.value));return{transform:[{translateX:scale*Math.cos(t.value)*Math.min(width/2-120,200)},{translateY:scale*(Math.sin(2*t.value)/2)*200}]};}"};function m(e){let{width:t}=e;const n=(0,s.useSharedValue)(0);(0,s.useFrameCallback)(function(){const e=function(e){n.value=e.timeSinceFirstFrame/350};return e.__closure={t:n},e.__workletHash=0x9b55df9bcbe,e.__initData=u,e}());const a=(0,s.useAnimatedStyle)(function(){const e=function(){const e=2/(3-Math.cos(2*n.value));return{transform:[{translateX:e*Math.cos(n.value)*Math.min(t/2-120,200)},{translateY:e*(Math.sin(2*n.value)/2)*200}]}};return e.__closure={t:n,width:t},e.__workletHash=7084236251646,e.__initData=c,e}());return r.createElement(o.Z,{style:d.container},r.createElement(s.default.View,{style:[d.dot,a]}))}const d=l.Z.create({container:{flex:1,alignItems:"center",justifyContent:"center",height:150},dot:{width:60,height:60,borderRadius:30,backgroundColor:"#b58df1",position:"absolute"}}),h="import React from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport Animated, {\n  useFrameCallback,\n  useSharedValue,\n  useAnimatedStyle,\n} from 'react-native-reanimated';\n\ninterface AppProps {\n  width: number;\n}\n\nexport default function App({ width }: AppProps) {\n  const t = useSharedValue<number>(0);\n\n  // highlight-start\n  useFrameCallback((frameInfo) => {\n    t.value = frameInfo.timeSinceFirstFrame / 350;\n  });\n  // highlight-end\n\n  const infinityStyle = useAnimatedStyle(() => {\n    const scale = 2 / (3 - Math.cos(2 * t.value));\n    return {\n      transform: [\n        {\n          translateX:\n            scale * Math.cos(t.value) * Math.min(width / 2 - 120, 200),\n        },\n        { translateY: scale * (Math.sin(2 * t.value) / 2) * 200 },\n      ],\n    };\n  });\n\n  return (\n    <View style={styles.container}>\n      <Animated.View style={[styles.dot, infinityStyle]} />\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: 'center',\n    justifyContent: 'center',\n    height: 150,\n  },\n  dot: {\n    width: 60,\n    height: 60,\n    borderRadius: 30,\n    backgroundColor: '#b58df1',\n    position: 'absolute',\n  },\n});\n";var v=n(70399),E=n(24404);const f=.6,p=5e-5,_=40,b=1e3,g={height:85,width:82,x:0,y:_},y={height:85,width:82,x:0,y:_},T={code:"function FrameCallbackDinoTsx1(frameInfo){const{DEFAULT_HORSE,horseY,DEFAULT_OBSTACLE,obstacleX,isColliding,gameOver,vx,width,VELOCITY_INCREMENT}=this.__closure;const{timeSincePreviousFrame:dt}=frameInfo;if(dt==null){return;}const horse={...DEFAULT_HORSE,y:horseY.value};const obstacle={...DEFAULT_OBSTACLE,x:obstacleX.value};if(isColliding(horse,obstacle)||gameOver.value){gameOver.value=true;return;}obstacleX.value=obstacleX.value>-100?obstacleX.value-vx.value*dt:width.value;vx.value+=VELOCITY_INCREMENT;}"},S={code:"function FrameCallbackDinoTsx2(){const{obstacleX,DEFAULT_OBSTACLE}=this.__closure;return{transform:[{translateX:obstacleX.value},{translateY:DEFAULT_OBSTACLE.y}]};}"},D={code:"function FrameCallbackDinoTsx3(){const{DEFAULT_HORSE,horseY}=this.__closure;return{transform:[{translateX:DEFAULT_HORSE.x},{translateY:horseY.value},{rotateY:'180deg'}]};}"},k={code:"function FrameCallbackDinoTsx4(){const{gameOver}=this.__closure;return{transform:[{translateY:gameOver.value===true?0:-1000}]};}"};function R(){const e=(0,s.useSharedValue)(f),t=(0,s.useSharedValue)(0),n=(0,s.useSharedValue)(b),a=(0,s.useSharedValue)(_),i=(0,s.useSharedValue)(!1);(0,s.useFrameCallback)(function(){const r=function(r){const{timeSincePreviousFrame:o}=r;if(null==o)return;const l={...y,y:a.value},s={...g,x:n.value};A(l,s)||i.value?i.value=!0:(n.value=n.value>-100?n.value-e.value*o:t.value,e.value+=p)};return r.__closure={DEFAULT_HORSE:y,horseY:a,DEFAULT_OBSTACLE:g,obstacleX:n,isColliding:A,gameOver:i,vx:e,width:t,VELOCITY_INCREMENT:p},r.__workletHash=3185936793975,r.__initData=T,r}());const l=(0,s.useAnimatedStyle)(function(){const e=()=>({transform:[{translateX:n.value},{translateY:g.y}]});return e.__closure={obstacleX:n,DEFAULT_OBSTACLE:g},e.__workletHash=598128048319,e.__initData=S,e}()),u=(0,s.useAnimatedStyle)(function(){const e=()=>({transform:[{translateX:y.x},{translateY:a.value},{rotateY:"180deg"}]});return e.__closure={DEFAULT_HORSE:y,horseY:a},e.__workletHash=7481394469968,e.__initData=D,e}()),c=(0,s.useAnimatedStyle)(function(){const e=()=>({transform:[{translateY:!0===i.value?0:-1e3}]});return e.__closure={gameOver:i},e.__workletHash=0xf0c9f5032be,e.__initData=k,e}()),m=()=>{a.value===_&&(a.value=(0,s.withSequence)((0,s.withTiming)(_-120,{easing:s.Easing.bezier(.3,.11,.15,.97)}),(0,s.withTiming)(_,{easing:s.Easing.poly(4)})))},d=()=>{i.value=!1,n.value=b,a.value=_,e.value=f};return r.createElement(r.Fragment,null,r.createElement(v.Z,{style:O.container,onLayout:e=>{t.value=e.nativeEvent.layout.width},onPressIn:()=>{i.value?d():m()}},r.createElement(s.default.View,{style:[O.overlay,c]},r.createElement(E.Z,{style:O.text},"Game Over")),r.createElement(s.default.Text,{style:[O.obstacle,l]},"\ud83c\udf35"),r.createElement(s.default.Text,{style:[O.horse,u]},"\ud83d\udc0e"),r.createElement(o.Z,{style:O.ground})))}const O=l.Z.create({container:{flex:1,height:200},horse:{position:"absolute",fontSize:80},ground:{position:"absolute",right:0,bottom:70,width:"100%",height:2,backgroundColor:"#000"},obstacle:{position:"absolute",fontSize:80},text:{fontSize:40,color:"white",backgroundColor:"rgba(0,0,0,0.5)",paddingHorizontal:8},overlay:{justifyContent:"center",alignItems:"center",position:"absolute",width:"100%",zIndex:1}}),P={code:"function isColliding_FrameCallbackDinoTsx5(obj1,obj2){return obj1.x<obj2.x+obj2.width&&obj1.x+obj1.width>obj2.x&&obj1.y<obj2.y+obj2.height&&obj1.y+obj1.height>obj2.y;}"},A=function(){const e=function(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y};return e.__closure={},e.__workletHash=9316259044170,e.__initData=P,e}(),C="import Animated, {\n  useSharedValue,\n  useFrameCallback,\n  useAnimatedStyle,\n  withSequence,\n  withTiming,\n  Easing,\n  FrameInfo,\n} from 'react-native-reanimated';\nimport {\n  View,\n  StyleSheet,\n  Pressable,\n  Text,\n  LayoutChangeEvent,\n} from 'react-native';\nimport React from 'react';\n\ninterface CollisionObject {\n  height: number;\n  width: number;\n  x: number;\n  y: number;\n}\n\nconst HEIGHT = 200;\nconst DEFAULT_VELOCITY = 0.6;\nconst VELOCITY_INCREMENT = 0.00005;\nconst GROUND_LEVEL = 80;\nconst DEFAULT_Y = HEIGHT - GROUND_LEVEL - 80;\nconst DEFAULT_X = 1000;\n\nconst DEFAULT_OBSTACLE = {\n  height: 85,\n  width: 82,\n  x: 0,\n  y: DEFAULT_Y,\n};\nconst DEFAULT_HORSE = {\n  height: 85,\n  width: 82,\n  x: 0,\n  y: DEFAULT_Y,\n};\n\nexport default function FrameCallbackDino() {\n  const vx = useSharedValue<number>(DEFAULT_VELOCITY);\n  const width = useSharedValue<number>(0);\n\n  const obstacleX = useSharedValue<number>(DEFAULT_X);\n  const horseY = useSharedValue<number>(DEFAULT_Y);\n\n  const gameOver = useSharedValue<boolean>(false);\n\n  const getDimensions = (event: LayoutChangeEvent) => {\n    width.value = event.nativeEvent.layout.width;\n  };\n\n  // highlight-next-line\n  useFrameCallback((frameInfo: FrameInfo) => {\n    const { timeSincePreviousFrame: dt } = frameInfo;\n    if (dt == null) {\n      return;\n    }\n\n    const horse: CollisionObject = { ...DEFAULT_HORSE, y: horseY.value };\n    const obstacle: CollisionObject = {\n      ...DEFAULT_OBSTACLE,\n      x: obstacleX.value,\n    };\n\n    if (isColliding(horse, obstacle) || gameOver.value) {\n      gameOver.value = true;\n      return;\n    }\n\n    obstacleX.value =\n      obstacleX.value > -100 ? obstacleX.value - vx.value * dt : width.value;\n\n    vx.value += VELOCITY_INCREMENT;\n    // highlight-next-line\n  });\n\n  const obstacleStyles = useAnimatedStyle(() => ({\n    transform: [\n      { translateX: obstacleX.value },\n      { translateY: DEFAULT_OBSTACLE.y },\n    ],\n  }));\n\n  const horseStyles = useAnimatedStyle(() => ({\n    transform: [\n      { translateX: DEFAULT_HORSE.x },\n      { translateY: horseY.value },\n      { rotateY: '180deg' },\n    ],\n  }));\n\n  const overlayStyles = useAnimatedStyle(() => ({\n    transform: [{ translateY: gameOver.value === true ? 0 : -1000 }],\n  }));\n\n  const handleTap = () => {\n    if (gameOver.value) {\n      handleRestart();\n    } else {\n      handleJump();\n    }\n  };\n\n  const handleJump = () => {\n    if (horseY.value === DEFAULT_Y) {\n      horseY.value = withSequence(\n        withTiming(DEFAULT_Y - 120, {\n          easing: Easing.bezier(0.3, 0.11, 0.15, 0.97),\n        }),\n        withTiming(DEFAULT_Y, { easing: Easing.poly(4) })\n      );\n    }\n  };\n\n  const handleRestart = () => {\n    gameOver.value = false;\n    obstacleX.value = DEFAULT_X;\n    horseY.value = DEFAULT_Y;\n    vx.value = DEFAULT_VELOCITY;\n  };\n\n  return (\n    <>\n      <Pressable\n        style={styles.container}\n        onLayout={getDimensions}\n        onPressIn={handleTap}>\n        <Animated.View style={[styles.overlay, overlayStyles]}>\n          <Text style={styles.text}>Game Over</Text>\n        </Animated.View>\n        <Animated.Text style={[styles.obstacle, obstacleStyles]}>\n          \ud83c\udf35\n        </Animated.Text>\n        <Animated.Text style={[styles.horse, horseStyles]}>\ud83d\udc0e</Animated.Text>\n        <View style={styles.ground} />\n      </Pressable>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    height: 200,\n  },\n  horse: {\n    position: 'absolute',\n    fontSize: 80,\n  },\n  ground: {\n    position: 'absolute',\n    right: 0,\n    bottom: GROUND_LEVEL - 10,\n    width: '100%',\n    height: 2,\n    backgroundColor: '#000',\n  },\n  obstacle: {\n    position: 'absolute',\n    fontSize: 80,\n  },\n  text: {\n    fontSize: 40,\n    color: 'white',\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    paddingHorizontal: 8,\n  },\n  overlay: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    position: 'absolute',\n    width: '100%',\n    zIndex: 1,\n  },\n});\n\nfunction isColliding(obj1: CollisionObject, obj2: CollisionObject) {\n  'worklet';\n  return (\n    obj1.x < obj2.x + obj2.width &&\n    obj1.x + obj1.width > obj2.x &&\n    obj1.y < obj2.y + obj2.height &&\n    obj1.y + obj1.height > obj2.y\n  );\n}\n",L={sidebar_position:3},N="useFrameCallback",x={unversionedId:"advanced/useFrameCallback",id:"advanced/useFrameCallback",title:"useFrameCallback",description:"useFrameCallback lets you run a function on every frame update.",source:"@site/docs/advanced/useFrameCallback.mdx",sourceDirName:"advanced",slug:"/advanced/useFrameCallback",permalink:"/react-native-reanimated/docs/advanced/useFrameCallback",draft:!1,editUrl:"https://github.com/software-mansion/react-native-reanimated/edit/main/packages/docs-reanimated/docs/advanced/useFrameCallback.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"useAnimatedReaction",permalink:"/react-native-reanimated/docs/advanced/useAnimatedReaction"},next:{title:"useEvent",permalink:"/react-native-reanimated/docs/advanced/useEvent"}},w={},F=[{value:"Reference",id:"reference",level:2},{value:"Arguments",id:"arguments",level:3},{value:"<code>callback</code>",id:"callback",level:4},{value:"<code>autostart</code> <Optional />",id:"autostart-",level:4},{value:"Returns",id:"returns",level:3},{value:"Example",id:"example",level:2},{value:"Remarks",id:"remarks",level:2},{value:"Platform compatibility",id:"platform-compatibility",level:2}],I=e=>function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)},j=I("InteractiveExample"),Y=I("Optional"),V=I("PlatformCompatibility"),U={toc:F},X="wrapper";function M(e){let{components:t,...n}=e;return(0,i.kt)(X,(0,a.Z)({},U,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"useframecallback"},"useFrameCallback"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"useFrameCallback")," lets you run a function on every frame update."),(0,i.kt)(j,{src:h,component:m,mdxType:"InteractiveExample"}),(0,i.kt)("h2",{id:"reference"},"Reference"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"import { useFrameCallback } from 'react-native-reanimated';\n\nfunction App() {\n  const frameCallback = useFrameCallback((frameInfo) => {\n    // Increment a value on every frame update\n    sv.value += 1;\n  });\n\n  return (\n    <Button\n      title=\"Start/Stop\"\n      onPress={() => frameCallback.setActive(!frameCallback.isActive)}\n    />\n  );\n}\n")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Type definitions"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"type FrameInfo = {\n  timestamp: number;\n  timeSincePreviousFrame: number | null;\n  timeSinceFirstFrame: number;\n};\n\ntype FrameCallback = {\n  setActive: (isActive: boolean) => void;\n  isActive: boolean;\n  callbackId: number;\n};\n\nfunction useFrameCallback(\n  callback: (frameInfo: FrameInfo) => void,\n  autostart = true\n): FrameCallback;\n"))),(0,i.kt)("h3",{id:"arguments"},"Arguments"),(0,i.kt)("h4",{id:"callback"},(0,i.kt)("inlineCode",{parentName:"h4"},"callback")),(0,i.kt)("p",null,"A function executed on every frame update. This function receives a ",(0,i.kt)("inlineCode",{parentName:"p"},"frameInfo")," object containing the following fields:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"timestamp")," a number indicating the system time (in milliseconds) when the last frame was rendered."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"timeSincePreviousFrame")," a number indicating the time (in milliseconds) since last frame. This value will be null on the first frame after activation. Starting from the second frame, it should be ~16 ms on 60 Hz, and ~8 ms on 120 Hz displays (provided there are no frame dropped)."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"timeSinceFirstFrame")," a number indicating the time (in milliseconds) since the callback was activated.")),(0,i.kt)("h4",{id:"autostart-"},(0,i.kt)("inlineCode",{parentName:"h4"},"autostart")," ",(0,i.kt)(Y,{mdxType:"Optional"})),(0,i.kt)("p",null,"Whether the callback should start automatically. Defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,i.kt)("h3",{id:"returns"},"Returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"useFrameCallback")," returns an object containing these fields:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"setActive")," a function that lets you start the frame callback or stop it from running"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"isActive")," a boolean indicating whether a callback is running"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"callbackId")," a number indicating a unique identifier of the frame callback")),(0,i.kt)("h2",{id:"example"},"Example"),(0,i.kt)(j,{src:C,component:R,label:"Tap to jump",mdxType:"InteractiveExample"}),(0,i.kt)("h2",{id:"remarks"},"Remarks"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A function passed to the ",(0,i.kt)("inlineCode",{parentName:"li"},"callback")," argument is automatically ",(0,i.kt)("a",{parentName:"li",href:"/docs/fundamentals/glossary#to-workletize"},"workletized")," and ran on the ",(0,i.kt)("a",{parentName:"li",href:"/docs/fundamentals/glossary#ui-thread"},"UI thread"),".")),(0,i.kt)("h2",{id:"platform-compatibility"},"Platform compatibility"),(0,i.kt)(V,{android:!0,ios:!0,web:!0,mdxType:"PlatformCompatibility"}))}M.isMDXComponent=!0},94119:(e,t,n)=>{n.d(t,{Z:()=>y});var a="DELAY",r="ERROR",i="LONG_PRESS_DETECTED",o="NOT_RESPONDER",l="RESPONDER_ACTIVE_LONG_PRESS_START",s="RESPONDER_ACTIVE_PRESS_START",u="RESPONDER_INACTIVE_PRESS_START",c="RESPONDER_RELEASE",m="RESPONDER_TERMINATED",d=Object.freeze({NOT_RESPONDER:{DELAY:r,RESPONDER_GRANT:u,RESPONDER_RELEASE:r,RESPONDER_TERMINATED:r,LONG_PRESS_DETECTED:r},RESPONDER_INACTIVE_PRESS_START:{DELAY:s,RESPONDER_GRANT:r,RESPONDER_RELEASE:o,RESPONDER_TERMINATED:o,LONG_PRESS_DETECTED:r},RESPONDER_ACTIVE_PRESS_START:{DELAY:r,RESPONDER_GRANT:r,RESPONDER_RELEASE:o,RESPONDER_TERMINATED:o,LONG_PRESS_DETECTED:l},RESPONDER_ACTIVE_LONG_PRESS_START:{DELAY:r,RESPONDER_GRANT:r,RESPONDER_RELEASE:o,RESPONDER_TERMINATED:o,LONG_PRESS_DETECTED:l},ERROR:{DELAY:o,RESPONDER_GRANT:u,RESPONDER_RELEASE:o,RESPONDER_TERMINATED:o,LONG_PRESS_DETECTED:o}}),h=e=>e===s||e===l,v=e=>"button"===e.getAttribute("role"),E=e=>e===u||e===s||e===l,f=e=>{var t=e.key,n=e.target.getAttribute("role");return"Enter"===t||(" "===t||"Spacebar"===t)&&"button"===n};class p{constructor(e){this._eventHandlers=null,this._isPointerTouch=!1,this._longPressDelayTimeout=null,this._longPressDispatched=!1,this._pressDelayTimeout=null,this._pressOutDelayTimeout=null,this._touchState=o,this.configure(e)}configure(e){this._config=e}reset(){this._cancelLongPressDelayTimeout(),this._cancelPressDelayTimeout(),this._cancelPressOutDelayTimeout()}getEventHandlers(){return null==this._eventHandlers&&(this._eventHandlers=this._createEventHandlers()),this._eventHandlers}_createEventHandlers(){var e=(e,t)=>{e.persist(),this._cancelPressOutDelayTimeout(),this._longPressDispatched=!1,this._selectionTerminated=!1,this._touchState=o,this._isPointerTouch="touchstart"===e.nativeEvent.type,this._receiveSignal("RESPONDER_GRANT",e);var n=_(this._config.delayPressStart,0,50);!1!==t&&n>0?this._pressDelayTimeout=setTimeout((()=>{this._receiveSignal(a,e)}),n):this._receiveSignal(a,e);var r=_(this._config.delayLongPress,10,450);this._longPressDelayTimeout=setTimeout((()=>{this._handleLongPress(e)}),r+n)},t=e=>{this._receiveSignal(c,e)},n=e=>{var a=this._config.onPress,r=e.target;if(this._touchState!==o&&f(e)){t(e),document.removeEventListener("keyup",n);var i=r.getAttribute("role"),l=r.tagName.toLowerCase();null==a||("link"===i||"a"===l||"button"===l||"input"===l||"select"===l||"textarea"===l)||a(e)}};return{onStartShouldSetResponder:e=>{var t=this._config.disabled;return t&&v(e.currentTarget)&&e.stopPropagation(),null==t||!t},onKeyDown:t=>{var a=this._config.disabled,r=t.key,i=t.target;if(!a&&f(t)){this._touchState===o&&(e(t,!1),document.addEventListener("keyup",n));var l=i.getAttribute("role");(" "===r||"Spacebar"===r)&&("button"===l||"menuitem"===l)&&t.preventDefault(),t.stopPropagation()}},onResponderGrant:t=>e(t),onResponderMove:e=>{null!=this._config.onPressMove&&this._config.onPressMove(e);var t=b(e);if(null!=this._touchActivatePosition){var n=this._touchActivatePosition.pageX-t.pageX,a=this._touchActivatePosition.pageY-t.pageY;Math.hypot(n,a)>10&&this._cancelLongPressDelayTimeout()}},onResponderRelease:e=>t(e),onResponderTerminate:e=>{"selectionchange"===e.nativeEvent.type&&(this._selectionTerminated=!0),this._receiveSignal(m,e)},onResponderTerminationRequest:e=>{var t=this._config,n=t.cancelable,a=t.disabled,r=t.onLongPress;return!(!a&&null!=r&&this._isPointerTouch&&"contextmenu"===e.nativeEvent.type)&&(null==n||n)},onClick:e=>{var t=this._config,n=t.disabled,a=t.onPress;n?v(e.currentTarget)&&e.stopPropagation():(e.stopPropagation(),this._longPressDispatched||this._selectionTerminated?e.preventDefault():null!=a&&!1===e.altKey&&a(e))},onContextMenu:e=>{var t=this._config,n=t.disabled,a=t.onLongPress;n?v(e.currentTarget)&&e.stopPropagation():null!=a&&this._isPointerTouch&&!e.defaultPrevented&&(e.preventDefault(),e.stopPropagation())}}}_receiveSignal(e,t){var n=this._touchState,a=null;null!=d[n]&&(a=d[n][e]),this._touchState===o&&e===c||(null==a||a===r?console.error("PressResponder: Invalid signal "+e+" for state "+n+" on responder"):n!==a&&(this._performTransitionSideEffects(n,a,e,t),this._touchState=a))}_performTransitionSideEffects(e,t,n,a){if((e=>e===m||e===c)(n)&&(setTimeout((()=>{this._isPointerTouch=!1}),0),this._touchActivatePosition=null,this._cancelLongPressDelayTimeout()),E(e)&&n===i){var r=this._config.onLongPress;null!=r&&null==a.nativeEvent.key&&(r(a),this._longPressDispatched=!0)}var o=h(e),s=h(t);if(!o&&s?this._activate(a):o&&!s&&this._deactivate(a),E(e)&&n===c){var u=this._config,d=u.onLongPress;if(null!=u.onPress)null!=d&&e===l||s||o||(this._activate(a),this._deactivate(a))}this._cancelPressDelayTimeout()}_activate(e){var t=this._config,n=t.onPressChange,a=t.onPressStart,r=b(e);this._touchActivatePosition={pageX:r.pageX,pageY:r.pageY},null!=a&&a(e),null!=n&&n(!0)}_deactivate(e){var t=this._config,n=t.onPressChange,a=t.onPressEnd;function r(){null!=a&&a(e),null!=n&&n(!1)}var i=_(this._config.delayPressEnd);i>0?this._pressOutDelayTimeout=setTimeout((()=>{r()}),i):r()}_handleLongPress(e){this._touchState!==s&&this._touchState!==l||this._receiveSignal(i,e)}_cancelLongPressDelayTimeout(){null!=this._longPressDelayTimeout&&(clearTimeout(this._longPressDelayTimeout),this._longPressDelayTimeout=null)}_cancelPressDelayTimeout(){null!=this._pressDelayTimeout&&(clearTimeout(this._pressDelayTimeout),this._pressDelayTimeout=null)}_cancelPressOutDelayTimeout(){null!=this._pressOutDelayTimeout&&(clearTimeout(this._pressOutDelayTimeout),this._pressOutDelayTimeout=null)}}function _(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),Math.max(t,null!=e?e:n)}function b(e){var t=e.nativeEvent,n=t.changedTouches,a=t.touches;return null!=a&&a.length>0?a[0]:null!=n&&n.length>0?n[0]:e.nativeEvent}var g=n(67294);function y(e,t){var n=(0,g.useRef)(null);null==n.current&&(n.current=new p(t));var a=n.current;return(0,g.useEffect)((()=>{a.configure(t)}),[t,a]),(0,g.useEffect)((()=>()=>{a.reset()}),[a]),(0,g.useDebugValue)(t),a.getEventHandlers()}}}]);